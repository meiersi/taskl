//db:
  uses:
  - //pg.root
  - //pg.branch

//web:
  uses:
  - //pg.branch
  - //node
  - //nginx

//node:
  uses:
  - //apt: [-y, install, nodejs, npm]
    uses:
    - //apt.ppa: [chris-lea/node.js]

//nginx:
  uses:
  - //apt: [-y, install, nginx-extras]
    uses:
    - //apt.ppa: [nginx/stable]

//pg.root:
  vars: [{version: "9.2"}]  # Variable with default.
  uses:
  - //apt:
    - [postgresql-,{version}], [postgresql-,{version},-dbg]
    - [postgresql-contrib-,{version}]
    - [postgresql-client-,{version}]
    - [postgresql-doc-,{version}]
    - [postgresql-server-dev-,{version}]
    uses:
    - //apt.ppa: [ pitti/postgresql ]

//pg.branch:
  vars: [{version: "9.2"}]  # Variable with default.
  uses:
  - //apt: [ -y, install, [postgresql-client-,{version}] ]
    uses:
    - //apt.ppa: [pitti/postgresql]

//apt.ppa:
  vars: [ppa]
  uses: //apt.ppa.setup
  cmds:
  - [add-apt-repository, ['ppa:',{ppa}]]

//apt.ppa.setup:
  cmds:
  - [aptitude, update]
  - [aptitude, -y, install, python-software-properties]

//apt.up:
  cmds:
  - [aptitude, update]

//apt:
  uses: //apt.up
  cmds:
  - [aptitude, -y, install, {...}]

