#!/bin/bash
# See what happens when bytes in 0x01..0xFF are passed to useradd.

set -o nounset

function addtrial {
  useradd "$1" || echo '!!' "$2"
}

function remove_if_exists {
  id "$1" && userdel "$1"  
}

case "$1" in
  trial)  task=addtrial ;;
  clear)  task=remove_if_exists ;;
  *)      echo 'Argument error; please read sources.' 1>&2 ; exit 2 ;;
esac

$task           $'ab\x01ba'     $'"\\SOH"'
$task           $'ab\x02ba'     $'"\\STX"'
$task           $'ab\x03ba'     $'"\\ETX"'
$task           $'ab\x04ba'     $'"\\EOT"'
$task           $'ab\x05ba'     $'"\\ENQ"'
$task           $'ab\x06ba'     $'"\\ACK"'
$task           $'ab\aba'       $'"\\a"'
$task           $'ab\bba'       $'"\\b"'
$task           $'ab\tba'       $'"\\t"'
$task           $'ab\nba'       $'"\\n"'
$task           $'ab\vba'       $'"\\v"'
$task           $'ab\fba'       $'"\\f"'
$task           $'ab\rba'       $'"\\r"'
$task           $'ab\x0Eba'     $'"\\SO"'
$task           $'ab\x0Fba'     $'"\\SI"'
$task           $'ab\x10ba'     $'"\\DLE"'
$task           $'ab\x11ba'     $'"\\DC1"'
$task           $'ab\x12ba'     $'"\\DC2"'
$task           $'ab\x13ba'     $'"\\DC3"'
$task           $'ab\x14ba'     $'"\\DC4"'
$task           $'ab\x15ba'     $'"\\NAK"'
$task           $'ab\x16ba'     $'"\\SYN"'
$task           $'ab\x17ba'     $'"\\ETB"'
$task           $'ab\x18ba'     $'"\\CAN"'
$task           $'ab\x19ba'     $'"\\EM"'
$task           $'ab\x1Aba'     $'"\\SUB"'
$task           $'ab\eba'       $'"\\ESC"'
$task           $'ab\x1Cba'     $'"\\FS"'
$task           $'ab\x1Dba'     $'"\\GS"'
$task           $'ab\x1Eba'     $'"\\RS"'
$task           $'ab\x1Fba'     $'"\\US"'
$task           $'ab ba'        $'" "'
$task           $'ab!ba'        $'"!"'
$task           $'ab"ba'        $'"\\""'
$task           $'ab#ba'        $'"#"'
$task           $'ab$ba'        $'"$"'
$task           $'ab%ba'        $'"%"'
$task           $'ab&ba'        $'"&"'
$task           $'ab\'ba'       $'"\'"'
$task           $'ab(ba'        $'"("'
$task           $'ab)ba'        $'")"'
$task           $'ab*ba'        $'"*"'
$task           $'ab+ba'        $'"+"'
$task           ab,ba           $'","'
$task           ab-ba           $'"-"'
$task           ab.ba           $'"."'
$task           ab/ba           $'"/"'
$task           ab0ba           $'"0"'
$task           ab1ba           $'"1"'
$task           ab2ba           $'"2"'
$task           ab3ba           $'"3"'
$task           ab4ba           $'"4"'
$task           ab5ba           $'"5"'
$task           ab6ba           $'"6"'
$task           ab7ba           $'"7"'
$task           ab8ba           $'"8"'
$task           ab9ba           $'"9"'
$task           $'ab:ba'        $'":"'
$task           $'ab;ba'        $'";"'
$task           $'ab<ba'        $'"<"'
$task           $'ab=ba'        $'"="'
$task           $'ab>ba'        $'">"'
$task           $'ab?ba'        $'"?"'
$task           ab@ba           $'"@"'
$task           abAba           $'"A"'
$task           abBba           $'"B"'
$task           abCba           $'"C"'
$task           abDba           $'"D"'
$task           abEba           $'"E"'
$task           abFba           $'"F"'
$task           abGba           $'"G"'
$task           abHba           $'"H"'
$task           abIba           $'"I"'
$task           abJba           $'"J"'
$task           abKba           $'"K"'
$task           abLba           $'"L"'
$task           abMba           $'"M"'
$task           abNba           $'"N"'
$task           abOba           $'"O"'
$task           abPba           $'"P"'
$task           abQba           $'"Q"'
$task           abRba           $'"R"'
$task           abSba           $'"S"'
$task           abTba           $'"T"'
$task           abUba           $'"U"'
$task           abVba           $'"V"'
$task           abWba           $'"W"'
$task           abXba           $'"X"'
$task           abYba           $'"Y"'
$task           abZba           $'"Z"'
$task           $'ab[ba'        $'"["'
$task           $'ab\\ba'       $'"\\\\"'
$task           $'ab]ba'        $'"]"'
$task           $'ab^ba'        $'"^"'
$task           $'ab_ba'        $'"_"'
$task           $'ab`ba'        $'"`"'
$task           ababa           $'"a"'
$task           abbba           $'"b"'
$task           abcba           $'"c"'
$task           abdba           $'"d"'
$task           abeba           $'"e"'
$task           abfba           $'"f"'
$task           abgba           $'"g"'
$task           abhba           $'"h"'
$task           abiba           $'"i"'
$task           abjba           $'"j"'
$task           abkba           $'"k"'
$task           ablba           $'"l"'
$task           abmba           $'"m"'
$task           abnba           $'"n"'
$task           aboba           $'"o"'
$task           abpba           $'"p"'
$task           abqba           $'"q"'
$task           abrba           $'"r"'
$task           absba           $'"s"'
$task           abtba           $'"t"'
$task           abuba           $'"u"'
$task           abvba           $'"v"'
$task           abwba           $'"w"'
$task           abxba           $'"x"'
$task           abyba           $'"y"'
$task           abzba           $'"z"'
$task           $'ab{ba'        $'"{"'
$task           $'ab|ba'        $'"|"'
$task           $'ab}ba'        $'"}"'
$task           $'ab~ba'        $'"~"'
$task           $'ab\x7Fba'     $'"\\DEL"'
$task           $'ab\x80ba'     $'"\\128"'
$task           $'ab\x81ba'     $'"\\129"'
$task           $'ab\x82ba'     $'"\\130"'
$task           $'ab\x83ba'     $'"\\131"'
$task           $'ab\x84ba'     $'"\\132"'
$task           $'ab\x85ba'     $'"\\133"'
$task           $'ab\x86ba'     $'"\\134"'
$task           $'ab\x87ba'     $'"\\135"'
$task           $'ab\x88ba'     $'"\\136"'
$task           $'ab\x89ba'     $'"\\137"'
$task           $'ab\x8Aba'     $'"\\138"'
$task           $'ab\x8Bba'     $'"\\139"'
$task           $'ab\x8Cba'     $'"\\140"'
$task           $'ab\x8Dba'     $'"\\141"'
$task           $'ab\x8Eba'     $'"\\142"'
$task           $'ab\x8Fba'     $'"\\143"'
$task           $'ab\x90ba'     $'"\\144"'
$task           $'ab\x91ba'     $'"\\145"'
$task           $'ab\x92ba'     $'"\\146"'
$task           $'ab\x93ba'     $'"\\147"'
$task           $'ab\x94ba'     $'"\\148"'
$task           $'ab\x95ba'     $'"\\149"'
$task           $'ab\x96ba'     $'"\\150"'
$task           $'ab\x97ba'     $'"\\151"'
$task           $'ab\x98ba'     $'"\\152"'
$task           $'ab\x99ba'     $'"\\153"'
$task           $'ab\x9Aba'     $'"\\154"'
$task           $'ab\x9Bba'     $'"\\155"'
$task           $'ab\x9Cba'     $'"\\156"'
$task           $'ab\x9Dba'     $'"\\157"'
$task           $'ab\x9Eba'     $'"\\158"'
$task           $'ab\x9Fba'     $'"\\159"'
$task           $'ab\xA0ba'     $'"\\160"'
$task           $'ab\xA1ba'     $'"\\161"'
$task           $'ab\xA2ba'     $'"\\162"'
$task           $'ab\xA3ba'     $'"\\163"'
$task           $'ab\xA4ba'     $'"\\164"'
$task           $'ab\xA5ba'     $'"\\165"'
$task           $'ab\xA6ba'     $'"\\166"'
$task           $'ab\xA7ba'     $'"\\167"'
$task           $'ab\xA8ba'     $'"\\168"'
$task           $'ab\xA9ba'     $'"\\169"'
$task           $'ab\xAAba'     $'"\\170"'
$task           $'ab\xABba'     $'"\\171"'
$task           $'ab\xACba'     $'"\\172"'
$task           $'ab\xADba'     $'"\\173"'
$task           $'ab\xAEba'     $'"\\174"'
$task           $'ab\xAFba'     $'"\\175"'
$task           $'ab\xB0ba'     $'"\\176"'
$task           $'ab\xB1ba'     $'"\\177"'
$task           $'ab\xB2ba'     $'"\\178"'
$task           $'ab\xB3ba'     $'"\\179"'
$task           $'ab\xB4ba'     $'"\\180"'
$task           $'ab\xB5ba'     $'"\\181"'
$task           $'ab\xB6ba'     $'"\\182"'
$task           $'ab\xB7ba'     $'"\\183"'
$task           $'ab\xB8ba'     $'"\\184"'
$task           $'ab\xB9ba'     $'"\\185"'
$task           $'ab\xBAba'     $'"\\186"'
$task           $'ab\xBBba'     $'"\\187"'
$task           $'ab\xBCba'     $'"\\188"'
$task           $'ab\xBDba'     $'"\\189"'
$task           $'ab\xBEba'     $'"\\190"'
$task           $'ab\xBFba'     $'"\\191"'
$task           $'ab\xC0ba'     $'"\\192"'
$task           $'ab\xC1ba'     $'"\\193"'
$task           $'ab\xC2ba'     $'"\\194"'
$task           $'ab\xC3ba'     $'"\\195"'
$task           $'ab\xC4ba'     $'"\\196"'
$task           $'ab\xC5ba'     $'"\\197"'
$task           $'ab\xC6ba'     $'"\\198"'
$task           $'ab\xC7ba'     $'"\\199"'
$task           $'ab\xC8ba'     $'"\\200"'
$task           $'ab\xC9ba'     $'"\\201"'
$task           $'ab\xCAba'     $'"\\202"'
$task           $'ab\xCBba'     $'"\\203"'
$task           $'ab\xCCba'     $'"\\204"'
$task           $'ab\xCDba'     $'"\\205"'
$task           $'ab\xCEba'     $'"\\206"'
$task           $'ab\xCFba'     $'"\\207"'
$task           $'ab\xD0ba'     $'"\\208"'
$task           $'ab\xD1ba'     $'"\\209"'
$task           $'ab\xD2ba'     $'"\\210"'
$task           $'ab\xD3ba'     $'"\\211"'
$task           $'ab\xD4ba'     $'"\\212"'
$task           $'ab\xD5ba'     $'"\\213"'
$task           $'ab\xD6ba'     $'"\\214"'
$task           $'ab\xD7ba'     $'"\\215"'
$task           $'ab\xD8ba'     $'"\\216"'
$task           $'ab\xD9ba'     $'"\\217"'
$task           $'ab\xDAba'     $'"\\218"'
$task           $'ab\xDBba'     $'"\\219"'
$task           $'ab\xDCba'     $'"\\220"'
$task           $'ab\xDDba'     $'"\\221"'
$task           $'ab\xDEba'     $'"\\222"'
$task           $'ab\xDFba'     $'"\\223"'
$task           $'ab\xE0ba'     $'"\\224"'
$task           $'ab\xE1ba'     $'"\\225"'
$task           $'ab\xE2ba'     $'"\\226"'
$task           $'ab\xE3ba'     $'"\\227"'
$task           $'ab\xE4ba'     $'"\\228"'
$task           $'ab\xE5ba'     $'"\\229"'
$task           $'ab\xE6ba'     $'"\\230"'
$task           $'ab\xE7ba'     $'"\\231"'
$task           $'ab\xE8ba'     $'"\\232"'
$task           $'ab\xE9ba'     $'"\\233"'
$task           $'ab\xEAba'     $'"\\234"'
$task           $'ab\xEBba'     $'"\\235"'
$task           $'ab\xECba'     $'"\\236"'
$task           $'ab\xEDba'     $'"\\237"'
$task           $'ab\xEEba'     $'"\\238"'
$task           $'ab\xEFba'     $'"\\239"'
$task           $'ab\xF0ba'     $'"\\240"'
$task           $'ab\xF1ba'     $'"\\241"'
$task           $'ab\xF2ba'     $'"\\242"'
$task           $'ab\xF3ba'     $'"\\243"'
$task           $'ab\xF4ba'     $'"\\244"'
$task           $'ab\xF5ba'     $'"\\245"'
$task           $'ab\xF6ba'     $'"\\246"'
$task           $'ab\xF7ba'     $'"\\247"'
$task           $'ab\xF8ba'     $'"\\248"'
$task           $'ab\xF9ba'     $'"\\249"'
$task           $'ab\xFAba'     $'"\\250"'
$task           $'ab\xFBba'     $'"\\251"'
$task           $'ab\xFCba'     $'"\\252"'
$task           $'ab\xFDba'     $'"\\253"'
$task           $'ab\xFEba'     $'"\\254"'
$task           $'ab\xFFba'     $'"\\255"'

